<div class="videos-page pb-8">
    <div class="inner-container pt-5">
        @if (mediaStoreService.viewModel$ | async; as vm) {
            <!-- Back link -->
            <a class="back-link mb-5" [routerLink]="['../']">
                <i class="fa-solid fa-chevron-left"></i>
                Back to {{ vm.title }}
            </a>

            <h1 class="page-title">Videos</h1>

            @if (videos$ | async; as videos) {
                <!-- Sort controls bar -->
                <div class="sort-bar mb-5">
                    <span class="sort-bar__count muted">
                        1â€“{{ videos.length }} of {{ videos.length }}
                    </span>
                    <div class="sort-bar__controls">
                        <i class="fa-solid fa-sliders muted"></i>
                        <span class="muted text-sm sort-label">Sort by</span>
                        <mat-select
                            class="sort-select"
                            [value]="sortField$ | async"
                            (selectionChange)="setSortField($event)"
                        >
                            <mat-option value="published_at">Date</mat-option>
                            <mat-option value="type">Type</mat-option>
                            <mat-option value="name">Name</mat-option>
                        </mat-select>
                        <button
                            class="sort-dir-btn"
                            (click)="toggleSortDirection()"
                        >
                            @if ((sortDirection$ | async) === "asc") {
                                <i class="fa-solid fa-arrow-up"></i>
                            } @else {
                                <i class="fa-solid fa-arrow-down"></i>
                            }
                        </button>
                    </div>
                </div>

                <!-- Video grid -->
                <div class="video-grid">
                    @for (video of videos; track video.id) {
                        <a
                            class="video-card"
                            [href]="getYoutubeUrl(video.key!)"
                            target="_blank"
                            rel="noopener"
                        >
                            <div class="video-card__thumb">
                                <img
                                    [src]="getYoutubeThumbnail(video.key!)"
                                    [alt]="video.name"
                                />
                                <div class="video-card__play">
                                    <i class="fa-solid fa-play"></i>
                                </div>
                                @if (video.type) {
                                    <span class="video-card__type-badge">{{
                                        video.type
                                    }}</span>
                                }
                                @if (video.official) {
                                    <span class="video-card__official-badge"
                                        >Official</span
                                    >
                                }
                            </div>
                            <div class="video-card__info">
                                <p class="video-card__title">
                                    {{ video.name }}
                                </p>
                                <p class="video-card__media muted text-sm">
                                    {{ vm.title }}
                                    @if (vm.year) {
                                        ({{ vm.year }})
                                    }
                                </p>
                                <div class="video-card__meta">
                                    @if (video.published_at) {
                                        <span class="muted text-sm">{{
                                            video.published_at
                                                | date: "mediumDate"
                                        }}</span>
                                    }
                                    @if (video.size) {
                                        <span class="video-card__quality muted">
                                            {{ video.size }}p
                                        </span>
                                    }
                                </div>
                            </div>
                        </a>
                    }
                </div>
            }
        }
    </div>
</div>
