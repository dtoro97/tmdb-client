<div class="videos-page pb-8">
    @if (mediaStoreService.viewModel$ | async; as vm) {
        <app-sub-page-banner
            [backdropPath]="vm.backdropPath"
            [parentTitle]="vm.title"
            [backLink]="['../']"
            pageTitle="Videos"
        />

        <div class="inner-container pt-5">
            @if (videos$ | async; as videos) {
                <div class="sort-bar mb-5">
                    <span class="sort-bar-count muted">
                        1â€“{{ videos.length }} of {{ videos.length }}
                    </span>
                    <div class="sort-bar-controls">
                        <i class="fa-solid fa-sliders muted"></i>
                        <span class="muted text-sm sort-label">Sort by</span>
                        <mat-select
                            class="sort-select"
                            [value]="sortField$ | async"
                            (selectionChange)="setSortField($event)"
                        >
                            <mat-option value="published_at">Date</mat-option>
                            <mat-option value="type">Type</mat-option>
                            <mat-option value="name">Name</mat-option>
                        </mat-select>
                        <button
                            class="sort-dir-btn"
                            (click)="toggleSortDirection()"
                        >
                            @if ((sortDirection$ | async) === "asc") {
                                <i class="fa-solid fa-arrow-up"></i>
                            } @else {
                                <i class="fa-solid fa-arrow-down"></i>
                            }
                        </button>
                    </div>
                </div>

                <div class="video-grid">
                    @for (video of videos; track video.id) {
                        <a
                            class="video-card"
                            [href]="getYoutubeUrl(video.key!)"
                            target="_blank"
                            rel="noopener"
                        >
                            <div class="video-card-thumb">
                                <img
                                    [src]="getYoutubeThumbnail(video.key!)"
                                    [alt]="video.name"
                                />
                                <div class="video-card-play">
                                    <i class="fa-solid fa-play"></i>
                                </div>
                                @if (video.type) {
                                    <span class="video-card-type-badge">{{
                                        video.type
                                    }}</span>
                                }
                                @if (video.official) {
                                    <span class="video-card-official-badge"
                                        >Official</span
                                    >
                                }
                            </div>
                            <div class="video-card-info">
                                <p class="video-card-title">
                                    {{ video.name }}
                                </p>
                                <p class="video-card-media muted text-sm">
                                    {{ vm.title }}
                                    @if (vm.year) {
                                        ({{ vm.year }})
                                    }
                                </p>
                                <div class="video-card-meta">
                                    @if (video.published_at) {
                                        <span class="muted text-sm">{{
                                            video.published_at
                                                | date: "mediumDate"
                                        }}</span>
                                    }
                                    @if (video.size) {
                                        <span class="video-card-quality muted">
                                            {{ video.size }}p
                                        </span>
                                    }
                                </div>
                            </div>
                        </a>
                    }
                </div>
            }
        </div>
    }
</div>
